{% extends "base.html" %}

{% block content %}

<link rel="stylesheet" href="{{ url_for('static', filename='css/dish_profile.css') }}">


<div class="wrapper">
    <div class="text-center">{{ dish.title }}</div>
    <div class="dish_buy">
        <div class="container">
            <div class="ii">
                <img class="image" src="{{ url_for('static', filename=dish.image) }}">
                <textarea class="info" style="padding: 2px;" readonly>{% if dish.description == '' %}Описания нет{% else %}{{ dish.description }}{% endif %}</textarea>
            </div>
            {% if current_user.role == 0 %}
            <style>
                .dish_buy {
                    margin: 0 auto;
                    width: auto;
                }

                .container {
                    width: auto;
                }

                .btns {
                    margin-bottom: 30px;
                }
            </style>
            <div class="btns">
                <a class="edit" href="/edit/dish/{{ dish.id }}">Редактировать</a>
                <a class="remove" onclick="OpenDialog('{{dish.id }}')">Удалить</a>
                <dialog id="di{{ dish.id }}">
                    <div class="dwrapper">
                        <div class="dheader">Удаление блюда!</div>
                        <div class="dmain">Вы хотите удалить блюдо "{{ dish.title }}" ?</div>
                        <hr class="dhr">
                        <div class="dfooter">
                            <div class="dbtns">
                                <a class="dremove" href="/delete/dish/{{ dish.id }}">Удалить</a>
                                <a class="dcancel" onclick="RemoveDialog('{{dish.id }}')">Отмена</a>
                            </div>
                        </div>
                    </div>
                </dialog>
                <script>
                    function OpenDialog(dish_id) {
                        document.getElementById(`di${dish_id}`).showModal();
                    }

                    function RemoveDialog(dish_id) {
                        document.getElementById(`di${dish_id}`).close();
                    }
                </script>
            </div>
            {% endif %}
        </div>
        {% if current_user.role != 0 %}
        <div class="buy">
            <div class="price">Цена - {{ dish.price }}₽</div>
            <a class="order" href="/add_dish/{{ dish.id }}">Добавить в корзину</a>
        </div>
        {% endif %}
        {% if current_user.role == 2 %}
        <div>
            <a href="/vote/{{ dish.id }}">Хотел бы видеть в бизнес-ланче</a>
        </div>
        {% endif %}
    </div>
    <hr>
    <h3>Отзывы</h3>
    <form method="post" enctype="multipart/form-data">
        {{ form.hidden_tag() }}
     <!-- About -->
                    {{ form.comment(class="form-control txta", type="text",
                    placeholder="Ваш отзыв") }}
                    {% for error in form.comment.errors %}
                    <p class="alert alert-danger" role="alert">
                        {{ error }}
                    </p>
                    {% endfor %}
                    <div>
                        {% for criteria in criterias %}

                                <div>
                                    <p>{{criteria.title}}</p>
                                    <input type="radio" id="star-5" name={{criteria.title}} value="1">
                                    <label for="star-5" title="Оценка «5»"></label>
                                    <input type="radio" id="star-4" name={{criteria.title}} value="2">
                                    <label for="star-4" title="Оценка «4»"></label>
                                    <input type="radio" id="star-3" name={{criteria.title}} value="3">
                                    <label for="star-3" title="Оценка «3»"></label>
                                    <input type="radio" id="star-2" name={{criteria.title}} value="4">
                                    <label for="star-2" title="Оценка «2»"></label>
                                    <input type="radio" id="star-1" name={{criteria.title}} value="5">
                                    <label for="star-1" title="Оценка «1»"></label>
                                </div>

                    </div>
                        {% endfor %}
                        <!-- Submit -->
                        {{ form.submit(class="submitbtn", value="Сохранить") }}

        {% for comment in dish_comments %}
        <div>
            <p>{{ comment.user.surname }}{{ comment.user.name }}</p>
            {% for valuation in valuations[comment.id] %}
            <div>
                <p>{{ valuation.criteria.title }}: {{ valuation.value }}</p>
            </div>
            {% endfor %}
            <textarea disabled>{{ comment.comment }}</textarea>
        </div>
        {% endfor %}
</div>

{% endblock %}

